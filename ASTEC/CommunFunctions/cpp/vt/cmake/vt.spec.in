Buildroot:      @CMAKE_CURRENT_BINARY_DIR@/_CPack_Packages/Linux/RPM/BUILDROOT/@CPACK_PACKAGE_FILE_NAME@
Summary:        @CPACK_PACKAGE_DESCRIPTION_SUMMARY@
Name:           @CPACK_PACKAGE_NAME@
Version:        @CPACK_PACKAGE_VERSION@
Release:        1%{?dist}
License:        @CPACK_RPM_PACKAGE_LICENSE@
Group:          @CPACK_RPM_PACKAGE_GROUP@
Vendor:         @CPACK_PACKAGE_VENDOR@
Prefix:         @CPACK_PACKAGING_INSTALL_PREFIX@
Requires:       @CPACK_RPM_PACKAGE_REQUIRES@

%define _rpmdir @CMAKE_CURRENT_BINARY_DIR@/_CPack_Packages/Linux/RPM
# this one doesn't work: (the result is  @CPACK_PACKAGE_NAME@-@CPACK_PACKAGE_VERSION@-src.rpm )
#%define _rpmfilename @CPACK_PACKAGE_FILE_NAME@.rpm
%define _rpmfilename @CPACK_PACKAGE_NAME@-@CPACK_PACKAGE_VERSION@-%{Release}-%{arch}.rpm
%define _unpackaged_files_terminate_build 0
%define _topdir @CMAKE_CURRENT_BINARY_DIR@/_CPack_Packages/Linux/RPM

%description
vt

# This is a shortcutted spec file generated by CMake RPM generator
# we skip _install step because CPack does that for us.
# We do only save CPack installed tree in _prepr
# and then restore it in build.
%prep
mv $RPM_BUILD_ROOT @CMAKE_CURRENT_BINARY_DIR@/_CPack_Packages/Linux/RPM/tmpBBroot

%install
if [ -e $RPM_BUILD_ROOT ];
then
  rm -Rf $RPM_BUILD_ROOT
fi
mv "@CMAKE_CURRENT_BINARY_DIR@/_CPack_Packages/Linux/RPM/tmpBBroot" $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/cmake
mkdir -p $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/python2.7/
mv $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/cmake $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/cmake/@CPACK_PACKAGE_NAME@
mv $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/modules $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/python2.7/@CPACK_PACKAGE_NAME@
perl -pi -e "s|/@CPACK_PACKAGING_INSTALL_PREFIX@/cmake|/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/cmake/@CPACK_PACKAGE_NAME@|g" $RPM_BUILD_ROOT/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/cmake/@CPACK_PACKAGE_NAME@/@CPACK_PACKAGE_NAME@Config.cmake


%files
%defattr(-,root,root,-)
/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_LIBDIR@/*
/@CPACK_PACKAGING_INSTALL_PREFIX@/bin/*
/@CPACK_PACKAGING_INSTALL_PREFIX@/include/*

%changelog
* Wed Dec 11 2013 Nicolas Niclausse <etienne.delclauxc@inria.fr> - @CPACK_PACKAGE_VERSION@-@CPACK_PACKAGE_RELEASE@
- first entry
